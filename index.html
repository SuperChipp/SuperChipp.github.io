<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Manager</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Platform Library -->
    <script src="https://apis.google.com/js/api.js"></script>
    
    <style>
        /* Custom scrollbar for dark mode */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; /* slate-800 */
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; /* slate-600 */
            border-radius: 6px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* slate-500 */
        }

        /* Chart.js responsive containers */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Loading Spinner */
        .loader {
            border-top-color: #3498db;
            -webkit-animation: spin 1s linear infinite;
            animation: spin 1s linear infinite;
        }
        @-webkit-keyframes spin {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Chart Animations */
        #pie-chart, #bar-chart {
            transition: transform 0.5s ease-out, opacity 0.5s ease-out;
            transform: scale(0.9);
            opacity: 0;
        }
        #pie-chart.loaded, #bar-chart.loaded {
            transform: scale(1);
            opacity: 1;
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 font-sans antialiased">

    <!-- Main Application Wrapper -->
    <div id="app-container" class="min-h-screen">
        
        <!-- Header -->
        <header class="bg-slate-800 shadow-md sticky top-0 z-40">
            <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex-shrink-0 flex items-center">
                        <svg class="h-8 w-8 text-blue-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.75A.75.75 0 013 4.5h.75m0 0H21m-18 0h18M3 6h18M3 6l.007.007M3 6a.75.75 0 01.75-.75h.75m0 0v.75a.75.75 0 01-.75.75h-.75M3.75 9v.75A.75.75 0 013 10.5h-.75m0 0v-.75A.75.75 0 013 9h.75m0 0H21m-18 0h18M3 10.5h18m-18 0l.007.007m-
.007-.007a.75.75 0 01.75-.75h.75m0 0v.75a.75.75 0 01-.75.75h-.75m0 0H21m-18 0h18M3 13.5h18M3 13.5l.007.007m-.007-.007a.75.75 0 01.75-.75h.75m0 0v.75a.75.75 0 01-.75.75h-.75m0 0H21m-18 0h18" />
                        </svg>
                        <span class="ml-3 text-2xl font-bold text-white">Personal Finance Manager</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span id="user-name" class="hidden text-sm font-medium text-slate-300"></span>
                        <button id="auth-button" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            Sign In with Google
                        </button>
                    </div>
                </div>
            </nav>
        </header>

        <!-- Main Content (Hidden by default) -->
        <main id="main-content" class="container mx-auto p-4 sm:p-6 lg:p-8 hidden">
            
            <!-- Dashboard Stats -->
            <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6">
                <!-- Current Balance -->
                <div class="bg-slate-800 p-5 rounded-xl shadow-lg flex items-center justify-between">
                    <div>
                        <div class="text-sm text-slate-400">Current Balance</div>
                        <div id="total-balance" class="text-3xl font-bold text-white mt-1">$0.00</div>
                        <div id="balance-trend" class="text-sm text-slate-500 mt-1">+0.0% vs last month</div>
                    </div>
                    <div class="text-blue-400">
                        <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0A2.25 2.25 0 0018.75 9.75H5.25A2.25 2.25 0 003 12m18 0v-6A2.25 2.25 0 0018.75 3.75H5.25A2.25 2.25 0 003 6v6" />
                        </svg>
                    </div>
                </div>
                <!-- Total Income -->
                <div class="bg-slate-800 p-5 rounded-xl shadow-lg flex items-center justify-between">
                    <div>
                        <div class="text-sm text-slate-400">Total Income</div>
                        <div id="total-income" class="text-3xl font-bold text-white mt-1">$0.00</div>
                        <div id="income-trend" class="text-sm text-slate-500 mt-1">+0.0% vs last month</div>
                    </div>
                    <div class="text-green-400">
                        <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941" />
                        </svg>
                    </div>
                </div>
                <!-- Total Expenses -->
                <div class="bg-slate-800 p-5 rounded-xl shadow-lg flex items-center justify-between">
                    <div>
                        <div class="text-sm text-slate-400">Total Expenses</div>
                        <div id="total-expenses" class="text-3xl font-bold text-white mt-1">$0.00</div>
                        <div id="expense-trend" class="text-sm text-slate-500 mt-1">+0.0% vs last month</div>
                    </div>
                    <div class="text-red-400">
                        <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6L9 12.75l4.286-4.286a11.948 11.948 0 014.306 6.43l.776 2.898m0 0l3.182-5.511m-3.182 5.51l-5.511-3.181" />
                        </svg>
                    </div>
                </div>
                <!-- Savings Rate -->
                <div class="bg-slate-800 p-5 rounded-xl shadow-lg flex items-center justify-between">
                    <div>
                        <div class="text-sm text-slate-400">Savings Rate</div>
                        <div id="savings-rate" class="text-3xl font-bold text-white mt-1">0.0%</div>
                        <div id="savings-trend" class="text-sm text-slate-500 mt-1">N/A</div>
                    </div>
                    <div class="text-yellow-400">
                        <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 11.21 12.77 10.5 12 10.5c-.77 0-1.536.71-2.121 1.256L9 15.182M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                    </div>
                </div>
            </section>

            <!-- Main grid (Charts + Actions) -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">

                <!-- Left Column (Charts) -->
                <div class="lg:col-span-2 flex flex-col gap-6">
                    
                    <!-- Income/Expense Pie Chart -->
                    <div class="bg-slate-800 p-5 rounded-xl shadow-lg">
                        <h2 class="text-xl font-semibold text-white mb-4">Income vs Expenses</h2>
                        <div class="chart-container" style="height: 300px;">
                            <canvas id="pie-chart"></canvas>
                        </div>
                    </div>

                    <!-- Income vs Expenses Bar Chart -->
                    <div class="bg-slate-800 p-5 rounded-xl shadow-lg">
                        <h2 class="text-xl font-semibold text-white mb-4">Income vs Expenses (Monthly)</h2>
                        <div class="chart-container" style="height: 300px;">
                            <canvas id="bar-chart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Right Column (Quick Actions) -->
                <div class="bg-slate-800 p-5 rounded-xl shadow-lg h-fit">
                    <h2 class="text-xl font-semibold text-white mb-4">Quick Actions</h2>
                    <div class="flex flex-col space-y-3">
                        <button id="add-transaction-btn-quick" class="w-full flex items-center justify-start text-left p-4 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors">
                            <svg class="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                            </svg>
                            <div>
                                <div class="font-medium text-white">Add New Transaction</div>
                                <div class="text-sm text-blue-100">Record income or expense</div>
                            </div>
                        </button>
                        
                        <button id="sync-button" class="w-full flex items-center justify-start text-left p-4 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors">
                            <svg class="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0 0v-4.992m0 4.992h-4.993" />
                            </svg>
                            <div>
                                <div class="font-medium text-white">Sync with Drive</div>
                                <div id="sync-status" class="text-sm text-slate-300">Last sync: Never</div>
                            </div>
                        </button>
                        
                        <button id="change-file-button" class="w-full flex items-center justify-start text-left p-4 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors">
                             <svg class="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                            </svg>
                            <div>
                                <div class="font-medium text-white">Change Google Sheet</div>
                                <div class="text-sm text-slate-300">Pick a different file</div>
                            </div>
                        </button>

                        <button id="settings-button" class="w-full flex items-center justify-start text-left p-4 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors">
                            <svg class="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                
